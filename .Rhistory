gene=as.matrix(gene)
predictedPtype <- pRRopheticPredict(testMatrix=gene,
drug="Bortezomib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014")
boxplot(predictedPtype)
df <- stack(list(NR = predictedPtype[((studyResponse == 'PGx_Responder = NR') & bortIndex)],
R = predictedPtype[((studyResponse == 'PGx_Responder = R') & bortIndex)]))
head(df)
ggplot(data = df,
aes(y = values,
x = ind))+
geom_boxplot(alpha = 0.3,
fill = c('#e94753','#47a4e9'))+
theme_bw()+
ylab('Predicted Bortezomib Sensitivity') +
xlab('Clinical Response')
### log2 and delete low expression genes
rt <-   read.csv("C:/Users/lenovo/Desktop/mRNABLCAmRNA.FPKM.csv",header = T,row.names = 1)
### log2 and delete low expression genes
rt <-   read.csv("C:/Users/lenovo/Desktop/mRNA/BLCAmRNA.FPKM.csv",header = T,row.names = 1)
dim(rt)
rt=log2(rt[,1:ncol(rt)]+1)
View(rt)
View(mRNAexp)
View(rt)
predictedPtype <- pRRopheticPredict(testMatrix=rt[1:1500,],
drug="Bortezomib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014")
rt=as.matrix(rt)
predictedPtype <- pRRopheticPredict(testMatrix=rt[1:1500,],
drug="Bortezomib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014")
boxplot(predictedPtype)
df <- stack(list(NR = predictedPtype[((studyResponse == 'PGx_Responder = NR') & bortIndex)],
R = predictedPtype[((studyResponse == 'PGx_Responder = R') & bortIndex)]))
head(df)
ggplot(data = df,
aes(y = values,
x = ind))+
geom_boxplot(alpha = 0.3,
fill = c('#e94753','#47a4e9'))+
theme_bw()+
ylab('Predicted Bortezomib Sensitivity') +
xlab('Clinical Response')
### log2 and delete low expression genes
rt <-   read.csv("C:/Users/lenovo/Desktop/mRNA/BLCAmRNA.FPKM.csv",header = T,row.names = 1,check.names = F)
dim(rt)
View(rt)
rt=log2(rt[,1:ncol(rt)]+1)
rt=as.matrix(rt)
rt=na.omit(rt)
View(rt)
rt[rt==0]<-NA
rt=na.omit(rt)
mRNAexp=rt[1:1500,]
usethis::use_data(mRNAexp,overwrite = T)
predictedPtype <- pRRopheticPredict(testMatrix=mRNAexp,
drug="Bortezomib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014")
boxplot(predictedPtype)
df <- stack(list(NR = predictedPtype[((studyResponse == 'PGx_Responder = NR') & bortIndex)],
R = predictedPtype[((studyResponse == 'PGx_Responder = R') & bortIndex)]))
head(df)
ggplot(data = df,
aes(y = values,
x = ind))+
geom_boxplot(alpha = 0.3,
fill = c('#e94753','#47a4e9'))+
theme_bw()+
ylab('Predicted Bortezomib Sensitivity') +
xlab('Clinical Response')
predictedPtype <- pRRopheticPredict(testMatrix=mRNAexp,
drug="AZD6244",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014")
boxplot(predictedPtype)
df <- stack(list(NR = predictedPtype[((studyResponse == 'PGx_Responder = NR') & bortIndex)],
R = predictedPtype[((studyResponse == 'PGx_Responder = R') & bortIndex)]))
head(df)
ggplot(data = df,
aes(y = values,
x = ind))+
geom_boxplot(alpha = 0.3,
fill = c('#e94753','#47a4e9'))+
theme_bw()+
ylab('Predicted Bortezomib Sensitivity') +
xlab('Clinical Response')
predictedPtype <- pRRopheticPredict(testMatrix=mRNAexp,
drug="PD-0332991",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014")
predictedPtype <- pRRopheticPredict(testMatrix=mRNAexp,
drug="RAF265",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014")
predictedPtype <- pRRopheticPredict(testMatrix=mRNAexp,
drug="TKI258",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014")
predictedPtype <- pRRopheticPredict(testMatrix=mRNAexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014")
#boxplot(predictedPtype)
df <- stack(list(NR = predictedPtype[((studyResponse == 'PGx_Responder = NR') & bortIndex)],
R = predictedPtype[((studyResponse == 'PGx_Responder = R') & bortIndex)]))
head(df)
ggplot(data = df,
aes(y = values,
x = ind))+
geom_boxplot(alpha = 0.3,
fill = c('#e94753','#47a4e9'))+
theme_bw()+
ylab('Predicted Bortezomib Sensitivity') +
xlab('Clinical Response')
"Predicted"+drug+"Sensitivity"
drug=""Bosutinib""
"Predicted"+drug+"Sensitivity"
drug=""Bosutinib"
drug="Bosutinib"
a="Predicted"+drug+"Sensitivity"
a=paste0("Predicted", drug,"Sensitivity")
drug="Bosutinib"
a=paste0("Predicted", drug,"Sensitivity")
a
a=paste("Predicted", drug,"Sensitivity")
a
drugsensitivity <-function(testMatrix=mRNAexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014",colours=c('#e94753','#47a4e9')){
predictedPtype <- pRRopheticPredict(testMatrix=testMatrix,
drug=drug,
tissueType = tissueType,
batchCorrect = batchCorrect,
selection=selection,
dataset = dataset)
df <- stack(list(NR = predictedPtype[((studyResponse == 'PGx_Responder = NR') & bortIndex)],
R = predictedPtype[((studyResponse == 'PGx_Responder = R') & bortIndex)]))
ggplot(data = df,
aes(y = values,
x = ind))+
geom_boxplot(alpha = 0.3,
fill = colours)+
theme_bw()+
ylab(paste("Predicted", drug,"Sensitivity")) +
xlab('Clinical Response')
}
data(mRNAexp)
drugsensitivity(testMatrix=mRNAexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014",colours=c('#e94753','#47a4e9'))
drugsensitivity <-function(testMatrix=mRNAexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014",colours=c('#e94753','#47a4e9')){
predictedPtype <- pRRopheticPredict(testMatrix=testMatrix,
drug=drug,
tissueType = tissueType,
batchCorrect = batchCorrect,
selection=selection,
dataset = dataset)
df <- stack(list(NR = predictedPtype[((studyResponse == 'PGx_Responder = NR') & bortIndex)],
R = predictedPtype[((studyResponse == 'PGx_Responder = R') & bortIndex)]))
ggplot(data = df,
aes(y = values,
x = ind))+
geom_boxplot(alpha = 0.3,
fill = colours)+
theme_bw()+
ylab(paste("Predicted", drug,"Sensitivity")) +
xlab('Clinical Response')
}
drugsensitivity(testMatrix=mRNAexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014",colours=c('#e94753','#47a4e9'))
library(pRRophetic)
drugsensitivity(testMatrix=mRNAexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014",colours=c('#e94753','#47a4e9'))
drugsensitivity <-function(testMatrix=mRNAexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014",colours=c('#e94753','#47a4e9')){
predictedPtype <- pRRopheticPredict(testMatrix=testMatrix,
drug=drug,
tissueType = tissueType,
batchCorrect = batchCorrect,
selection=selection,
dataset = dataset)
df <- stack(list(NR = predictedPtype[((studyResponse == 'PGx_Responder = NR') & bortIndex)],
R = predictedPtype[((studyResponse == 'PGx_Responder = R') & bortIndex)]))
ggplot(data = df,
aes(y = values,
x = ind))+
geom_boxplot(alpha = 0.3,
fill = colours)+
theme_bw()+
ylab(paste("Predicted", drug,"Sensitivity")) +
xlab('Clinical Response')
}
drugsensitivity(testMatrix=mRNAexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014",colours=c('#e94753','#47a4e9'))
drugsensitivity <-function(testMatrix=mRNAexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014",colours=c('#e94753','#47a4e9')){
predictedPtype <- SuppressWarnings(pRRopheticPredict(testMatrix=testMatrix,
drug=drug,
tissueType = tissueType,
batchCorrect = batchCorrect,
selection=selection,
dataset = dataset))
df <- stack(list(NR = predictedPtype[((studyResponse == 'PGx_Responder = NR') & bortIndex)],
R = predictedPtype[((studyResponse == 'PGx_Responder = R') & bortIndex)]))
ggplot(data = df,
aes(y = values,
x = ind))+
geom_boxplot(alpha = 0.3,
fill = colours)+
theme_bw()+
ylab(paste("Predicted", drug,"Sensitivity")) +
xlab('Clinical Response')
}
drugsensitivity(testMatrix=mRNAexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014",colours=c('#e94753','#47a4e9'))
drugsensitivity <-function(testMatrix=mRNAexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014",colours=c('#e94753','#47a4e9')){
predictedPtype <- suppressWarnings(pRRopheticPredict(testMatrix=testMatrix,
drug=drug,
tissueType = tissueType,
batchCorrect = batchCorrect,
selection=selection,
dataset = dataset))
df <- stack(list(NR = predictedPtype[((studyResponse == 'PGx_Responder = NR') & bortIndex)],
R = predictedPtype[((studyResponse == 'PGx_Responder = R') & bortIndex)]))
ggplot(data = df,
aes(y = values,
x = ind))+
geom_boxplot(alpha = 0.3,
fill = colours)+
theme_bw()+
ylab(paste("Predicted", drug,"Sensitivity")) +
xlab('Clinical Response')
}
drugsensitivity(testMatrix=mRNAexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014",colours=c('#e94753','#47a4e9'))
predictedPtype <- suppressWarnings(pRRopheticPredict(testMatrix=mRNAexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014"))
df <- stack(list(NR = predictedPtype[((studyResponse == 'PGx_Responder = NR') & bortIndex)],
R = predictedPtype[((studyResponse == 'PGx_Responder = R') & bortIndex)]))
boxplot(predictedPtype)
head(predictedPtype)
df <- stack(list(NR = predictedPtype[((studyResponse == 'PGx_Responder = NR') & bortIndex)],
R = predictedPtype[((studyResponse == 'PGx_Responder = R') & bortIndex)]))
predictedPtype
predictedPtype <- pRRopheticPredict(testMatrix=mRNAexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014")
df <- stack(list(NR = predictedPtype[((studyResponse == 'PGx_Responder = NR') & bortIndex)],
R = predictedPtype[((studyResponse == 'PGx_Responder = R') & bortIndex)]))
predictedPtype
a=as.data.frame(predictedPtype)
View(a)
predictedPtype <- pRRopheticPredict(testMatrix=mRNAexp,
drug="Bortezomib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014")
df <- stack(list(NR = predictedPtype[((studyResponse == 'PGx_Responder = NR') & bortIndex)],
R = predictedPtype[((studyResponse == 'PGx_Responder = R') & bortIndex)]))
predictedPtype <- pRRopheticPredict(testMatrix=mRNAexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014")
mRNAexp=as.integer(mRNAexp)
predictedPtype <- pRRopheticPredict(testMatrix=mRNAexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014")
mRNAexp=as.matrix(as.integer(mRNAexp))
predictedPtype <- pRRopheticPredict(testMatrix=mRNAexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014")
View(a)
View(mRNAexp)
mRNAexp=as.integer(mRNAexp)
mRNAexp=as.numeric(mRNAexp)
data("mRNAexp")
mRNAexp=as.numeric(mRNAexp)
data("mRNAexp")
mRNAexp=as.data.frame(mRNAexp)
mRNAexp=as.numeric(mRNAexp)
View(mRNAexp)
data("mRNAexp")
mRNAexp=round(mRNAexp, 0)
View(mRNAexp)
predictedPtype <- pRRopheticPredict(testMatrix=mRNAexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014")
df <- stack(list(NR = predictedPtype[((studyResponse == 'PGx_Responder = NR') & bortIndex)],
R = predictedPtype[((studyResponse == 'PGx_Responder = R') & bortIndex)]))
genexp=read.csv("C:\\Users\\lenovo\\Desktop\\by\\数据\\BLCA_gene_expression.csv",header = T,row.names = 1)
genexp=read.csv("C:\\Users\\lenovo\\Desktop\\by\\数据\\BLCA_gene_expression.csv",header = T,row.names = 1)
predictedPtype <- pRRopheticPredict(testMatrix=genexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014")
genexp=as.matrix(genexp)
predictedPtype <- pRRopheticPredict(testMatrix=genexp,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014")
df <- stack(list(NR = predictedPtype[((studyResponse == 'PGx_Responder = NR') & bortIndex)],
R = predictedPtype[((studyResponse == 'PGx_Responder = R') & bortIndex)]))
#a=paste("Predicted", drug,"Sensitivity")
library(pRRophetic)
data(ccleData)
predictedPtype <- pRRopheticPredict(exprDataBortezomib, "Bortezomib",
selection=1)
data(bortezomibData)
predictedPtype <- pRRopheticPredict(exprDataBortezomib, "Bortezomib",
selection=1)
df <- stack(list(NR=predictedPtype_blood[((studyResponse == "PGx_Responder = NR")
& bortIndex)], R=predictedPtype_blood[((studyResponse == "PGx_Responder = R") &
bortIndex)]))
df <- stack(list(NR=predictedPtype[((studyResponse == "PGx_Responder = NR")
& bortIndex)], R=predictedPtype_blood[((studyResponse == "PGx_Responder = R") &
bortIndex)]))
df <- stack(list(NR=predictedPtype[((studyResponse == "PGx_Responder = NR")
& bortIndex)], R=predictedPtype[((studyResponse == "PGx_Responder = R") &
bortIndex)]))
ggplot(data=df, aes(y=values, x=ind)) + geom_boxplot(alpha=.3, fill=c("#CC0033", "#006633")) +
theme_bw() + ylab("Predicted Bortezomib Sensitivity") + xlab("Clinical Response")
library(ggplot)
library(ggplot2)
ggplot(data=df, aes(y=values, x=ind)) + geom_boxplot(alpha=.3, fill=c("#CC0033", "#006633")) +
theme_bw() + ylab("Predicted Bortezomib Sensitivity") + xlab("Clinical Response")
data(bortezomibData)
View(exprDataBortezomib)
predictedPtype <- pRRopheticPredict(mRNAexp, "Bortezomib",
selection=1)
data("mRNAexp")
predictedPtype <- pRRopheticPredict(mRNAexp, "Bortezomib",
selection=1)
df <- stack(list(NR=predictedPtype[((studyResponse == "PGx_Responder = NR")
& bortIndex)], R=predictedPtype[((studyResponse == "PGx_Responder = R") &
bortIndex)]))
data(bortezomibData)
table(studyResponse)
df <- stack(list(NR=predictedPtype[((studyResponse == "PGx_Responder = NR")
& bortIndex)], R=predictedPtype[((studyResponse == "PGx_Responder = R") &
bortIndex)]))
ggplot(data=df, aes(y=values, x=ind)) + geom_boxplot(alpha=.3, fill=c("#CC0033", "#006633")) +
theme_bw() + ylab("Predicted Bortezomib Sensitivity") + xlab("Clinical Response")
data(bortezomibData)
save(studyResponse,exprDataBortezomib,"C:/Users/lenovo/Desktop/by/数据/testmartix.Rdata")
save(studyResponse,exprDataBortezomib,file="C:/Users/lenovo/Desktop/by/数据/testmartix.Rdata")
exprData=exprDataBortezomib[1:1500,]
save(studyResponse,exprData,file="C:/Users/lenovo/Desktop/by/数据/testmartix.Rdata")
usethis::use_data(C:/Users/lenovo/Desktop/by/数据/testmartix.Rdata)
usethis::use_data("C:/Users/lenovo/Desktop/by/数据/testmartix.Rdata")
testmatrix=load("C:/Users/lenovo/Desktop/by/数据/testmartix.Rdata")
testmatrix
usethis::use_data(testmatrix)
data(testmatrix)
devtools::document()
data(testmatrix)
devtools::document()
data(testmatrix)
load("C:/Users/lenovo/Desktop/by/数据/testmartix.Rdata")
testmatrix=list(exprData,studyResponse)
View(testmatrix)
View(testmatrix)
testmatrix[[1]]
names( testmatrix[[1]])=exprData
all.files = c("exprData", "studyResponse")
all.files = c(exprData, studyResponse)
name(studyResponse)
names(studyResponse)
a=as.data.frame(studyResponse)
View(a)
usethis::use_data(exprData)
usethis::use_data(studyResponse)
devtools::document()
data(exprData)
data(studyResponse)
drugsensitivity(testMatrix=exprData,
studyResponse=studyResponse,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014",colours=c('#e94753','#47a4e9'))
data(bortezomibData)
predictedPtype[((studyResponse == 'PGx_Responder = NR') & bortIndex)]
usethis::use_data(bortIndex)
drugsensitivity(testMatrix=exprData,
studyResponse=studyResponse,
drug="Bosutinib",
tissueType = "all",
batchCorrect = "eb",
selection=1,
dataset = "cgp2014",colours=c('#e94753','#47a4e9'))
devtools::document()
devtools::document()
library(clusterProfiler)
data(gcSample)
# 准备数据:
df1=table(mtcars$carb, mtcars$am); df1
df2=as.data.frame(df1)
# 准备数据:
df1=table(mtcars$carb, mtcars$am)
df2=as.data.frame(df1)
View(df2)
colnames(df2)=c("carb", "am", "count")
df2
#
library(ggplot2)
# 基础版: 分类是堆叠的
ggplot(df2, aes(x=carb, y=count, fill=am))+
geom_bar(stat = "identity")+ #identity表示按照当前值画，否则还要统计个数
theme_classic()+ggtitle("Fig 1")
mtcars$carb
mtcars$am
mtcars$am=c(1,1,1,0,0,0,2,0,0,0,2,0,0,0,2,0,0,1,1,1,0,0,2,0,0,1,1,1,1,1,1,1)
# 准备数据:
df1=table(mtcars$carb, mtcars$am)
df2=as.data.frame(df1)
colnames(df2)=c("carb", "am", "count")
df2
# 基础版: 分类是堆叠的
ggplot(df2, aes(x=carb, y=count, fill=am))+
geom_bar(stat = "identity")+ #identity表示按照当前值画，否则还要统计个数
theme_classic()+ggtitle("Fig 1")
